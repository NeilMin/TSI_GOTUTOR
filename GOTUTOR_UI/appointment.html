<!DOCTYPE HTML>
<html lang="en">
<head>
    <link href="styles.css" rel="stylesheet">
    <title>GoTutor!</title>
    <link href='https://unpkg.com/@fullcalendar/core@4.4.0/main.min.css' rel='stylesheet' />
    <link href='https://unpkg.com/@fullcalendar/daygrid@4.4.0/main.min.css' rel='stylesheet' />
    <link href='https://unpkg.com/@fullcalendar/timegrid@4.4.0/main.min.css' rel='stylesheet' />
    <script src='https://unpkg.com/@fullcalendar/core@4.4.0/main.js'></script>
    <script src='https://unpkg.com/@fullcalendar/daygrid@4.4.0/main.js'></script>
    <script src='https://unpkg.com/@fullcalendar/timegrid@4.4.0/main.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.dev.js"></script>



  <script>
  const socket = io.connect('http://gotutor.com');
  document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('cal');
    const colorMap=new Map([["yes","blue"],["no","grey"],["me","yellow"]]);
    var calendar = new FullCalendar.Calendar(calendarEl, {
      events: '/fetchAppointments',
      plugins: [ 'timeGrid' ],
      eventClick:function( eventClickInfo ){
          var prompt=document.createElement("div");
          
          var question=document.createElement("textarea");
          question.value="What is your question?";
          prompt.appendChild(question);
          
          var submit=document.createElement("button")
          var submitText=document.createElement("p")
          submitText.textContent="submit"
          submit.appendChild(submitText);
          submit.onclick=function(){
              socket.emit('reserve',{id: eventClickInfo.event.id,question:question.value})
              prompt.remove()
          }
          prompt.appendChild(submit)
          
          prompt.onclick=function(e){e.stopPropagation()};
          eventClickInfo.el.appendChild(prompt)
          
      },
      eventDataTransform :function(info){
          //info.event.setProp("backgroundColor",colorMap.get(info.event.extendedProps.available))
          info.backgroundColor=colorMap.get(info.available)
          console.log(info)
      },
      defaultView: 'timeGridWeek',
      header: false
    });

    console.log(calendar.render());

    //setTimeout(()=>{console.log(calendar.getEvents())},1000)
  });

</script>
</head>

<body>
<div class="bg-main">
    <div class="container">
        <nav>
            <img src="images/GoTutor.png" alt="logo" class="logo">
            <ul class="classrooms">
                <li>
                    <a href="#ClassroomID=1">CSE 140</a>
                </li>
                <li>
                    <a href="#ClassroomID=2">CSE 101</a>
                </li>
                <li>
                    <a href="#ClassroomID=3">CSE 130</a>
                </li>
                <li>
                    <a href="#ClassroomID=4">CSE 110</a>
                </li>
                <li>
                    <a href="#ClassroomID=5">CSE 140L</a>
                </li>
            </ul>
            <ul class="navigation">
                </li>
                <li><a href="writeup.html">Assignment</a></li>
                <li><a href="classroom.html">Classroom</a></li>
                <li style="color: #F3E500;">Appointments</li>
                <li><a href="forum.html">Forum</a></li>
                <li><a href="tutor.html">Tutors</a></li>
                <li><a href="ticket.html">Tickets</a></li>
                <li><a href="setting.html">Settings</a></li>
                <li><a href="help.html">Help</a></li>
                <li><a href="#">Logout</a></li>
            </ul>
        </nav>
        <div class="content">
            <div class="student">
				<div id="cal"/>
                Section for student:
                <br/>
                <table id="submittedAppointments">
                    Upcoming appointments submitted
                    <tr>
                        <th>Number</th>
                        <th>Tutor name</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Problem</th>
                        <th>Submission date</th>
                        <th>Submission time</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>01</td>
                        <td>Smith</td>
                        <td>0407</td>
                        <td>1200</td>
                        <td>Installation problem</td>
                        <td>0514</td>
                        <td>0707</td>
                        <td>Pending</td>
                    </tr>
                </table>
                <br />
                <form id="createAppointment">
                    Create an appointment
                    <br/>
                    <label>Tutor name</label>
                    <select id="tutorNameList">
                        <option value="1">one</option>
                        <option value="2">two</option>
                        <option value="3">three</option>
                        <option value="4">four</option>
                    </select>
                    <label>Date</label>
                    <select id="appointmentDate">
                        <option value="1">one</option>
                        <option value="2">two</option>
                        <option value="3">three</option>
                        <option value="4">four</option>
                    </select>
                    <label>Time</label>
                    <select id="appointmentTime">
                        <option value="1">one</option>
                        <option value="2">two</option>
                        <option value="3">three</option>
                        <option value="4">four</option>
                    </select>
                    <label>
                        Problem
                        <input/>
                    </label>
                    <button id="add">Create</button>
                </form>
                <br />
                <table id="pastAppointment">
                    Past appointments
                    <tr>
                        <th>Number</th>
                        <th>Tutor name</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Problem</th>
                        <th>Submission date</th>
                        <th>Submission time</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>01</td>
                        <td>Smith</td>
                        <td>0407</td>
                        <td>1200</td>
                        <td>Installation problem</td>
                        <td>0514</td>
                        <td>1925</td>
                        <td>Declined/Approved</td>
                    </tr>
                </table>
            </div>
            <br/>
            <div class="tutor">
                Section for tutor:
                <br/>
                <table id="acceptedAppointment">
                    Accepted appointments
                    <tr>
                        <th>Number</th>
                        <th>Student name</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Problem</th>
                        <th>Submission date</th>
                        <th>Submission time</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>01</td>
                        <td>Smith</td>
                        <td>0407</td>
                        <td>1200</td>
                        <td>Installation problem</td>
                        <td>0514</td>
                        <td>1924</td>
                        <td>Approved</td>
                    </tr>
                </table>
                <br />
                <form id="cancelAppointment">
                    <label>Cancel appointments</label>
                    <select id="acceptedAppointmentList">
                        <option value="1">one</option>
                        <option value="2">two</option>
                        <option value="3">three</option>
                        <option value="4">four</option>
                    </select>
                    <button id="cancel">Cancel</button>
                </form>
                <br />
                <table id="futureAppointment">
                    Future appointments
                    <tr>
                        <th>Number</th>
                        <th>Student name</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Problem</th>
                        <th>Submission date</th>
                        <th>Submission time</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>01</td>
                        <td>Smith</td>
                        <td>0407</td>
                        <td>1200</td>
                        <td>Installation problem</td>
                        <td>0514</td>
                        <td>1924</td>
                        <td>Pending</td>
                    </tr>
                </table>
                <br />
                <label>Select an appointment</label>
                <select id="futureAppointmentList">
                    <option value="1">one</option>
                    <option value="2">two</option>
                    <option value="3">three</option>
                    <option value="4">four</option>
                </select>
                <button id="Approve">Approve</button>
                <button id="Decline">Decline</button>
                <br/>
                <br />
                <table id="pastAppointment">
                    Past appointments
                    <tr>
                        <th>Number</th>
                        <th>Student name</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Problem</th>
                        <th>Submission date</th>
                        <th>Submission time</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>01</td>
                        <td>Smith</td>
                        <td>0407</td>
                        <td>1200</td>
                        <td>Installation problem</td>
                        <td>0514</td>
                        <td>1925</td>
                        <td>Declined/Approved</td>
                    </tr>
                </table>
                <br />
                <label>Select an appointment</label>
                <select id="pastAppointmentList">
                    <option value="1">one</option>
                    <option value="2">two</option>
                    <option value="3">three</option>
                    <option value="4">four</option>
                </select>
                <button id="requestFeedback">Request feedback</button>
            </div>
        </div>
    </div>
</div>
</body>
