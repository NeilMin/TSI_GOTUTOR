<!DOCTYPE HTML>
<head>
    <link rel="stylesheet" href="styles.css">
    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id"
          content="294184945438-apd7ktfqguua67c4u06oq69sajq7nteq.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <title>GoTutor!</title>
</head>

<body>
<div class="bg-main">
    <div class="fg-text">
        <h1>GoTutor! by TSI.</h1>
        <p>The tutor-focused solution.</p>
        <div class="g-signin2"
             data-onsuccess="onSignIn"
             data-theme="dark"
             data-width="300"></div>
        <div id="login-failed-reason"></div>
        <script>
            function isAuthenticated() {
                if (this.readyState === 4 && this.status === 200) {
                    let response = JSON.parse(this.responseText);
                    if (response.success) {
                        for (userInfo in response.userInfos) {
                            sessionStorage.setItem(userInfo, response.userInfos[userInfo]);
                        }
                        window.location.replace("appointment.html#ClassroomID=1"); //TODO: Load some classroom from the user!
                    } else {
                        document.getElementById("login-login-failed-reason").innerHTML = response.failedReason;
                    }
                }
            }

            function onSignIn(googleUser) {
                let id_token = googleUser.getAuthResponse().id_token;
                xhr = new XMLHttpRequest();
                xhr.addEventListener("load", isAuthenticated);
                xhr.open("POST", 'googleAuth', true);
                xhr.send(id_token);
            }
        </script>
    </div>
</div>

<div class="copyright">
    <span>This project is considered proprietary software of the following named individuals.</span><br>
    <span>Reproduction of any code or design on this site is prohibited in accordance with the UCSD policy of Academic integrity.</span><br>
    <span>This site should only be referenced for grading the assignment given in CSE 110 by instructor Gary Gillespie.</span><br>
    <span>This software is not intended for use outside of the CSE 110 team. Use at your own caution.</span>
</div>
</body>